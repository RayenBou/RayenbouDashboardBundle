{% extends "@RayenbouDashboard/dashboard/base.html.twig" %}

{% block title %}Dashboard Ticket
{% endblock %}

{% block body %}
	<div class='container border border mt-4 p-4'>
		<h2 class='text-center '>Ticket list</h2>
		<div class='container mt-4 p-4'>

			<div class="row ">

				<div class="col-md-6 border p-3">
					<h2>Users</h2>
					{% for user in apiUser %}
						<div class="d-flex justify-content-between align-items-center mb-2">
							<div>
								{{ user.id }}
								-
								{{ user.email }}
							</div>
							<form method="post" action="{{ path('rayenbou_dashboard_user_delete', {'id': user.id}) }}" onsubmit="return confirm('Are you sure you want to delete this item?');">
								<input type="hidden" name="_token" value="{{ csrf_token('delete' ~ user.id) }}">
								<button class="btn btn-danger btn-sm">Delete</button>
							</form>
						</div>
					{% endfor %}
				</div>

				<div class="col-md-6 border p-3">
					<h2>Create User</h2>
					{{ include('@RayenbouDashboard/dashboard/_form.html.twig') }}
				</div>
			</div>
		</div>
		<table class="table table-striped p-5">
			<thead>
				<tr>
					<th>Id</th>
					<th>Title</th>
					<th>CreatedAt</th>
					<th>Domain</th>
					<th>Status</th>
					<th>actions</th>
				</tr>
			</thead>
			<tbody>
				{% for ticket in tickets %}
					<tr>
						<td>{{ ticket.id }}</td>
						<td>{{ ticket.title }}</td>

						<td>{{ ticket.createdAt ? ticket.createdAt|date('Y-m-d H:i:s') : '' }}</td>
						<td class="lead {{ ticket.status ? 'text-success' : 'text-danger' }}">{{ticket.status ? "open" : "closed"}}</td>
						<td>{{ ticket.domain }}</td>
						<td>
							<a href="{{ path('rayenbou_dashboard_show', {'id': ticket.id}) }}" class="btn btn-dark">See conversation</a>

						</td>
					</tr>
				{% else %}
					<tr>
						<td colspan="7">no records found</td>
					</tr>
				{% endfor %}
			</tbody>
		</table>


	</div>
{% endblock %}
